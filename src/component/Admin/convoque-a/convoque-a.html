<!-- ‚úÖ PAGE CONVOCATIONS ‚Äì ADMIN VOIT TOUT -->
<div class="relative min-h-screen flex flex-col justify-start items-center bg-gradient-to-br from-gray-50 to-gray-100 p-8">

    <!-- ===== EN-T√äTE ===== -->
    <header *ngIf="!loading && userInConvocations.length" class="text-center mb-12 flex flex-col items-center w-full max-w-6xl">
      <h1 id="convoc-title"
          class="text-center text-xl sm:text-2xl md:text-3xl lg:text-4xl font-extrabold bg-gradient-to-r from-gray-900 via-gray-800 to-rose-600 bg-clip-text text-transparent drop-shadow-lg mt-2 flex items-center justify-center gap-3">
        <i class="fa-solid fa-clipboard-list text-rose-600"></i> Liste des Convocations
      </h1>
    </header>
  
    <!-- ===== GRILLE DES CONVOCATIONS ===== -->
    <div *ngIf="!loading && userInConvocations.length"
         class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 w-full max-w-7xl mx-auto">
  
      <div *ngFor="let c of userInConvocations; index as i"
           class="group bg-white/90 backdrop-blur-sm rounded-2xl px-6 border-2 border-gray-200 transition-all duration-300 relative overflow-hidden shadow hover:shadow-xl">
  
        <!-- üî∏ En-t√™te convocation -->
        <div class="flex flex-col items-center text-center py-4">
          <p class="text-lg font-bold text-rose-600 flex items-center gap-2">
            <i class="fa-solid fa-futbol"></i> {{ c.match }}
          </p>
          <p class="text-sm text-gray-600 flex items-center gap-2 mt-1">
            <i class="fa-regular fa-calendar-days text-rose-500"></i>
            {{ c.date | date:'fullDate':'':'fr' }}
            <i class="fa-regular fa-clock ml-2 text-rose-500"></i>
            {{ c.date | date:'shortTime':'':'fr' }}
          </p>
          <p class="text-sm text-gray-700 mt-1 flex items-center gap-2">
            <i class="fa-solid fa-location-dot text-rose-500"></i> {{ c.lieu }}
          </p>
          <p *ngIf="userConnecte?.role === 'admin'" class="mt-2 text-xs text-gray-500 italic flex items-center gap-2">
            <i class="fa-solid fa-users-line text-gray-500"></i>
            √âquipe : <span class="font-semibold text-gray-700">{{ c.equipe }}</span>
          </p>
        </div>
  
        <hr class="my-3 border-gray-200" />
  
        <!-- üî∏ Liste joueurs -->
        <ul role="list" class="space-y-3">
          <li *ngFor="let joueur of c.joueurs; index as j"
              class="flex items-center gap-4 p-3 rounded-xl transition-all duration-200"
              [ngClass]="{
                'bg-amber-50 border-2 border-amber-300 shadow-md': userConnecte && joueur.nom === userConnecte.nom && joueur.prenom === userConnecte.prenom && !joueur.hasClicked,
                'bg-green-50 border border-green-200': joueur.etatPresence === 'present',
                'bg-red-50 border border-red-200': joueur.etatPresence === 'absent'
              }">
  
            <div class="flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm"
                 [ngClass]="{
                   'bg-green-500 text-white': joueur.etatPresence === 'present',
                   'bg-red-500 text-white': joueur.etatPresence === 'absent',
                   'bg-gray-100 text-gray-600': !joueur.etatPresence
                 }">
              <i *ngIf="joueur.etatPresence === 'present'" class="fa-solid fa-check"></i>
              <i *ngIf="joueur.etatPresence === 'absent'" class="fa-solid fa-xmark"></i>
              <span *ngIf="!joueur.etatPresence">{{ j + 1 }}</span>
            </div>
  
            <div class="flex-1 min-w-0">
              <p class="text-gray-900 font-semibold text-sm sm:text-base truncate flex items-center gap-2">
                <i class="fa-regular fa-user text-gray-500"></i> {{ joueur.prenom }} {{ joueur.nom }}
              </p>
              <p *ngIf="joueur.etatPresence" class="text-xs text-gray-500 capitalize flex items-center gap-1 mt-1">
                <i [ngClass]="{
                  'fa-solid fa-circle-check text-green-500': joueur.etatPresence === 'present',
                  'fa-solid fa-circle-xmark text-red-500': joueur.etatPresence === 'absent'
                }"></i>
                {{ joueur.etatPresence === 'present' ? 'Pr√©sent' : 'Absent' }}
              </p>
            </div>
  
            <!-- üî∏ Boutons pour le joueur connect√© -->
            <div *ngIf="userConnecte && joueur.nom === userConnecte.nom && joueur.prenom === userConnecte.prenom && c._id"
                 class="flex gap-2 ml-2">
              <button (click)="updatePresence(c, true)" [disabled]="!canClick(c)"
                      class="px-3 py-2 rounded-lg text-white shadow-lg flex items-center justify-center transition-all duration-200"
                      [ngClass]="{'bg-green-500 hover:bg-green-600': canClick(c), 'bg-green-300 cursor-not-allowed opacity-70': !canClick(c)}">
                <i class="fa-solid fa-thumbs-up"></i>
              </button>
              <button (click)="updatePresence(c, false)" [disabled]="!canClick(c)"
                      class="px-3 py-2 rounded-lg text-white shadow-lg flex items-center justify-center transition-all duration-200"
                      [ngClass]="{'bg-red-500 hover:bg-red-600': canClick(c), 'bg-red-300 cursor-not-allowed opacity-70': !canClick(c)}">
                <i class="fa-solid fa-thumbs-down"></i>
              </button>
            </div>
          </li>
        </ul>
      </div>
    </div>
  
    <!-- ===== NOTIFICATION ===== -->
    <div *ngIf="notificationMessage"
         class="fixed bottom-6 right-6 bg-gray-800 text-white px-4 py-2 rounded-lg shadow-lg animate-fade-in-out flex items-center gap-2">
      <i class="fa-solid fa-bell"></i> {{ notificationMessage }}
    </div>
  </div>
  
  <style>
  @keyframes fade-in-out {
    0% { opacity: 0; transform: translateY(10px); }
    10% { opacity: 1; transform: translateY(0); }
    90% { opacity: 1; transform: translateY(0); }
    100% { opacity: 0; transform: translateY(-10px); }
  }
  .animate-fade-in-out { animation: fade-in-out 3s ease forwards; }
  </style>
  
  <!-- ‚úÖ Font Awesome -->
  <script src="https://kit.fontawesome.com/4f2b4fcd53.js" crossorigin="anonymous"></script>
  