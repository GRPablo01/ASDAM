<!-- ‚úÖ Bouton compact : Cr√©er / Modifier un √©v√©nement -->
<div class="flex justify-center mt-6 px-4 sm:px-6 lg:px-0">
    <button *ngIf="canEdit()"
            (click)="showPopup = true"
            aria-label="Cr√©er ou modifier un √©v√©nement"
            class="group flex flex-col items-center justify-center w-28 h-28
                   bg-gradient-to-br from-[var(--Rouge-Fonc√©)] to-[var(--Rouge)]
                   text-[var(--Blanc)] font-semibold rounded-xl shadow-md
                   hover:from-[var(--Bleu)] hover:to-[var(--Bleu-Fonc√©)]
                   hover:shadow-lg hover:-translate-y-0.5 hover:scale-105
                   transition-all duration-300 ease-out
                   focus:outline-none focus:ring-2 focus:ring-rose-400/40">
      <i class="fa-solid fa-calendar-plus text-2xl text-white mb-1 transition-transform duration-300 group-hover:rotate-12"></i>
      <span class="uppercase tracking-wide text-xs leading-tight text-white">
        {{ isEditing ? 'Modifier' : 'Cr√©er' }}
      </span>
      <span class="text-[10px] opacity-80 text-white">√âv√©nement</span>
    </button>
</div>

<!-- üü• Modal √âv√©nement -->
<div *ngIf="showPopup"
     class="fixed inset-0 z-50 flex items-center justify-center p-4 sm:p-6
            bg-black/70 backdrop-blur-sm animate-fadeIn">

  <div class="w-full max-w-lg sm:max-w-xl md:max-w-2xl max-h-[90vh]
              rounded-3xl shadow-2xl overflow-hidden
              bg-[var(--Blanc)] text-[var(--Black)]
              dark:bg-[var(--Black)] dark:text-[var(--Blanc)]
              border border-[var(--Gris)] dark:border-[var(--Gris)]/40
              backdrop-blur-xl flex flex-col animate-slideUp">

    <!-- Header -->
    <header class="px-6 py-5 bg-gradient-to-br from-[var(--Rouge)] to-[var(--Rouge-Fonc√©)]
                   text-[var(--Blanc)] flex justify-between items-center
                   dark:from-[var(--Rouge-Clair)] dark:to-[var(--Rouge)]
                   transition-colors duration-500">
      <h2 class="text-xl sm:text-2xl font-bold">
        {{ isEditing ? 'Modifier √©v√©nement' : 'Nouvel √©v√©nement' }}
      </h2>
      <button (click)="showPopup=false"
              class="p-2 rounded-full hover:bg-white/20 dark:hover:bg-black/30 transition">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </header>

    <p class="text-sm text-[var(--Gris)] dark:text-[var(--Gris-Clair)] mt-1 px-6">
      Remplissez les informations de l'√©v√©nement
    </p>

    <!-- üßæ Formulaire -->
    <form (ngSubmit)="addEvent()"
          class="flex-1 px-6 py-6 space-y-5 overflow-y-auto">

      <input type="text" placeholder="Titre" [(ngModel)]="newEventTitle" name="title" required
             class="w-full rounded-xl border border-[var(--Gris)]/40 bg-transparent
                    px-3 sm:px-4 py-2 sm:py-3 shadow-sm
                    text-[var(--Black)] dark:text-[var(--Blanc)]
                    placeholder:text-[var(--Gris)] dark:placeholder:text-[var(--Gris-Clair)]
                    focus:ring-2 focus:ring-[var(--Rouge-Clair)] focus:border-[var(--Rouge-Clair)] transition" />

      <input type="date" [(ngModel)]="newEventDate" name="date" required
             class="w-full rounded-xl border border-[var(--Gris)]/40 bg-transparent
                    px-3 sm:px-4 py-2 sm:py-3 shadow-sm
                    text-[var(--Black)] dark:text-[var(--Blanc)]
                    focus:ring-2 focus:ring-[var(--Rouge-Clair)] transition" />

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <input type="time" [(ngModel)]="newEventHour" name="hour" required
               class="w-full rounded-xl border border-[var(--Gris)]/40 bg-transparent
                      px-3 sm:px-4 py-2 sm:py-3 shadow-sm
                      text-[var(--Black)] dark:text-[var(--Blanc)]
                      focus:ring-2 focus:ring-[var(--Rouge-Clair)] transition" />
        <input type="time" [(ngModel)]="newEventEndHour" name="endHour" required
               class="w-full rounded-xl border border-[var(--Gris)]/40 bg-transparent
                      px-3 sm:px-4 py-2 sm:py-3 shadow-sm
                      text-[var(--Black)] dark:text-[var(--Blanc)]
                      focus:ring-2 focus:ring-[var(--Rouge-Clair)] transition" />
      </div>

      <input type="text" placeholder="Votre Nom . Votre Pr√©nom" [(ngModel)]="newEventCoach" name="coach"
             class="w-full rounded-xl border border-[var(--Gris)]/40 bg-transparent
                    px-3 sm:px-4 py-2 sm:py-3 shadow-sm
                    text-[var(--Black)] dark:text-[var(--Blanc)]
                    placeholder:text-[var(--Gris)] dark:placeholder:text-[var(--Gris-Clair)]
                    focus:ring-2 focus:ring-[var(--Rouge-Clair)] transition" />

      <select [(ngModel)]="newEventCategory" name="category"
              class="w-full rounded-xl border border-[var(--Gris)]/40 bg-transparent
                     px-3 sm:px-4 py-2 sm:py-3 shadow-sm
                     text-[var(--Black)] dark:text-[var(--Blanc)]
                     focus:ring-2 focus:ring-[var(--Rouge-Clair)] transition">
        <option value="" disabled selected>Cat√©gorie</option>
        <option *ngFor="let cat of categories" [value]="cat">{{ cat }}</option>
      </select>

      <select [(ngModel)]="newEventLevel" name="level"
              class="w-full rounded-xl border border-[var(--Gris)]/40 bg-transparent
                     px-3 sm:px-4 py-2 sm:py-3 shadow-sm
                     text-[var(--Black)] dark:text-[var(--Blanc)]
                     focus:ring-2 focus:ring-[var(--Rouge-Clair)] transition">
        <option value="" disabled selected>Niveau</option>
        <option *ngFor="let lvl of levels" [value]="lvl">{{ lvl }}</option>
      </select>

      <textarea placeholder="Description" [(ngModel)]="newEventDescription" rows="4" name="description"
                class="w-full rounded-xl border border-[var(--Gris)]/40 bg-transparent
                       px-3 sm:px-4 py-2 sm:py-3 shadow-sm
                       text-[var(--Black)] dark:text-[var(--Blanc)]
                       placeholder:text-[var(--Gris)] dark:placeholder:text-[var(--Gris-Clair)]
                       focus:ring-2 focus:ring-[var(--Rouge-Clair)] transition"></textarea>
    </form>

    <!-- Footer -->
    <footer class="px-6 py-4 border-t border-[var(--Gris)]/40 dark:border-[var(--Gris)]/60 flex justify-end gap-4">
      <button (click)="showPopup=false"
              class="px-5 py-2 rounded-xl bg-[var(--Gris)]/20 dark:bg-[var(--Blanc)]/10
                     text-[var(--Black)] dark:text-[var(--Blanc)]
                     hover:bg-[var(--Gris)]/30 dark:hover:bg-[var(--Blanc)]/20 transition">
        Annuler
      </button>

      <button (click)="addEvent()"
              class="px-5 py-2 rounded-xl bg-gradient-to-br from-[var(--Rouge)] to-[var(--Rouge-Fonc√©)]
                     text-[var(--Blanc)] font-semibold shadow-lg
                     hover:scale-105 transition-transform duration-200 ease-in-out
                     dark:from-[var(--Rouge-Clair)] dark:to-[var(--Rouge)]">
        {{ isEditing ? 'Modifier' : 'Ajouter' }}
      </button>
    </footer>
  </div>
</div>