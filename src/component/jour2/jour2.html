<!-- jour2.html -->
<div class="min-h-screen flex flex-col p-4 sm:p-6 bg-white/90 backdrop-blur-lg text-[var(--Black)] relative overflow-hidden">

  <!-- ===== IMAGE DE FOND ===== -->
  <img src="/assets/texture.png" alt="Texture de fond"
    class="absolute inset-0 w-full h-full object-cover -mt-32 mix-blend-soft-light scale-105 transition-all duration-700" />

  <!-- ===== SUPERPOSITION GRADIENT ===== -->
  <div class="absolute inset-0 bg-gradient-to-b from-white/50 via-white/30 to-white/50 backdrop-blur-xl"></div>

  <!-- ===== CONTENU PRINCIPAL ===== -->
  <div class="relative z-10 flex flex-col gap-6">

    <!-- ===== HEADER ===== -->
    <header class="mt-20 flex flex-col md:flex-row items-center justify-between gap-4 mb-6 p-6 bg-gradient-to-r from-[var(--Rouge)] to-[var(--Rouge-Foncé)] text-white rounded-2xl shadow-xl">
      <h1 class="text-3xl sm:text-4xl font-extrabold drop-shadow-lg flex items-center gap-2">
        <i class="fas fa-calendar-alt text-2xl sm:text-3xl" aria-hidden="true"></i>
        Aujourd'hui {{ dayName(currentDateStr) }} {{ dayNum(currentDateStr) }} – Demain {{ dayNum(nextDateStr) }}
      </h1>
      <button *ngIf="canEdit()" (click)="openPopup()"
        class="inline-flex items-center gap-2 px-5 py-2.5 rounded-lg bg-[var(--Rouge)] hover:bg-[var(--Bleu)] text-[var(--Blanc)] font-semibold shadow-md hover:shadow-lg transition-all duration-200">
        <i class="fas fa-plus"></i>
        Créer un événement
      </button>
    </header>

    <!-- ===== MATCHS + ÉVÉNEMENTS ===== -->
<section class="flex flex-col gap-6">
  <h2 class="text-2xl font-bold text-indigo-700">Agenda</h2>
  <div class="flex flex-col gap-6">
    <div *ngFor="let day of [currentDateStr, nextDateStr]">
      <h3 class="text-xl font-semibold text-indigo-700 mb-2">
        {{ day === currentDateStr ? 'Aujourd’hui' : 'Demain' }}
      </h3>

      <!-- Récupère tous les items du jour (matchs + événements) -->
      <div *ngIf="(getMatchesByDate(day).length + getEventsByDay(day).length) === 0" class="text-gray-400 italic">
        Aucun élément.
      </div>

      <div class="flex gap-4 overflow-x-auto scrollbar-thin scrollbar-thumb-indigo-300 scrollbar-track-gray-200">
        <!-- MATCHS -->
        <div *ngFor="let match of getMatchesByDate(day)" (click)="openMatchDetails(match)"
          class="flex-shrink-0 w-72 p-5 rounded-2xl bg-gradient-to-br from-indigo-600 to-blue-600 text-white shadow-lg hover:scale-[1.03] transition cursor-pointer">
          <div class="flex items-center justify-between mb-3">
            <div class="flex items-center gap-2">
              <img *ngIf="match.logoA" [src]="match.logoA" alt="{{match.equipeA}} logo" class="w-8 h-8 rounded-full object-cover">
              <span class="font-semibold">{{ match.equipeA }}</span>
            </div>
            <span class="text-sm">VS</span>
            <div class="flex items-center gap-2">
              <img *ngIf="match.logoB" [src]="match.logoB" alt="{{match.equipeB}} logo" class="w-8 h-8 rounded-full object-cover">
              <span class="font-semibold">{{ match.equipeB }}</span>
            </div>
          </div>
          <div class="text-xs text-white/80 mb-2">
            <p>Catégorie : {{ match.categorie }}</p>
            <p>Lieu : {{ match.lieu }}</p>
          </div>
          <div class="flex justify-between items-center">
            <span class="text-xs bg-white/20 text-white px-3 py-1 rounded-full">{{ match.date | date:'HH:mm' }}</span>
            <span *ngIf="match.status" class="text-xs bg-white/30 text-white px-3 py-1 rounded-full">{{ match.status }}</span>
          </div>
        </div>

        <!-- ÉVÉNEMENTS -->
        <div *ngFor="let evt of getEventsByDay(day)" (click)="openEventDetails(evt)"
          class="flex-shrink-0 w-72 p-5 rounded-2xl shadow-lg hover:shadow-2xl hover:scale-[1.03] transition cursor-pointer relative"
          [ngClass]="getEventColor(evt)">
          <span *ngIf="evt.level" class="absolute top-3 right-3 text-xs bg-white/30 text-white px-3 py-1 rounded-full uppercase font-semibold">
            {{ evt.level }}
          </span>
          <div class="flex items-start gap-3 mb-3">
            <i [class]="getEventIcon(evt) + ' text-white text-xl'"></i>
            <div>
              <p class="font-semibold text-lg text-white">{{ evt.title }}</p>
              <p class="text-sm opacity-80 text-white">{{ evt.coach }}</p>
            </div>
          </div>
          <div *ngIf="evt.description" class="mb-2">
            <p class="text-xs text-white/70 mb-1 font-semibold">Description</p>
            <p class="text-sm text-white/90 line-clamp-3">{{ evt.description }}</p>
          </div>
          <div class="flex justify-between items-center">
            <span class="text-xs bg-white/20 text-white px-3 py-1 rounded-full uppercase">{{ evt.category }}</span>
            <span class="text-sm font-mono text-white">{{ evt.hour }} - {{ evt.endHour }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


  </div>

  <!-- ===== POPUP DÉTAIL ÉVÉNEMENT ===== -->
  <div *ngIf="selectedEvent"
    class="fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-lg p-4">
    <div class="w-full max-w-lg rounded-3xl bg-white/90 backdrop-blur-2xl border border-gray-300 shadow-2xl p-8 text-gray-900 relative">
      <button (click)="closeEventDetails()" aria-label="Fermer"
        class="absolute top-4 right-4 p-2 rounded-full bg-gray-200 hover:bg-[var(--Rouge)] hover:text-[var(--Blanc)] transition">
        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>

      <header [ngClass]="getEventColor(selectedEvent)" class="rounded-2xl p-4 text-white mb-4">
        <i [class]="getEventIcon(selectedEvent) + ' text-3xl mb-2'"></i>
        <h2 class="text-2xl font-bold">{{ selectedEvent.title }}</h2>
        <p class="text-sm opacity-90">{{ selectedEvent.category }} · {{ selectedEvent.level }}</p>
      </header>

      <section class="space-y-4">
        <div class="flex items-start gap-3">
          <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          <div>
            <p class="text-xs text-gray-500">Date</p>
            <p class="font-medium">{{ formatFullDate(selectedEvent.day) }}</p>
          </div>
        </div>

        <div class="flex items-start gap-3">
          <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <div>
            <p class="text-xs text-gray-500">Horaire</p>
            <p class="font-medium">{{ selectedEvent.hour }} – {{ selectedEvent.endHour }}</p>
          </div>
        </div>

        <div class="flex items-start gap-3">
          <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
          </svg>
          <div>
            <p class="text-xs text-gray-500">Responsable</p>
            <p class="font-medium">{{ selectedEvent.coach }}</p>
          </div>
        </div>

        <div *ngIf="selectedEvent.description" class="flex items-start gap-3">
          <i class="fas fa-file-alt w-6 h-6 text-red-600 flex-none"></i>
          <div>
            <p class="text-xs text-gray-500">Description</p>
            <p class="font-medium whitespace-pre-wrap">{{ selectedEvent.description }}</p>
          </div>
        </div>
      </section>

      <footer *ngIf="canEdit()" class="flex justify-end gap-3 mt-6">
        <button (click)="deleteEvent(selectedEvent)"
          class="px-5 py-2 rounded-xl bg-red-600 hover:bg-red-700 text-white font-semibold transition">Supprimer</button>
      </footer>
    </div>
  </div>

  <!-- ===== POPUP DÉTAIL MATCH ===== -->
  <div *ngIf="selectedMatch"
    class="fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-lg p-4">
    <div class="w-full max-w-lg rounded-3xl bg-white/90 backdrop-blur-2xl border border-gray-300 shadow-2xl p-8 text-gray-900 relative">
      <button (click)="closeMatchDetails()" aria-label="Fermer"
        class="absolute top-4 right-4 p-2 rounded-full bg-gray-200 hover:bg-[var(--Rouge)] hover:text-[var(--Blanc)] transition">
        <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>

      <header class="bg-gradient-to-r from-indigo-600 to-blue-600 rounded-2xl p-4 text-white mb-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <img [src]="selectedMatch.logoA" class="w-10 h-10 rounded-full object-cover" />
            <span class="font-bold text-lg">{{ selectedMatch.equipeA }}</span>
          </div>
          <div class="text-2xl font-bold" *ngIf="selectedMatch.scoreA != null">
            {{ selectedMatch.scoreA }} – {{ selectedMatch.scoreB }}
          </div>
          <div class="flex items-center gap-3">
            <img [src]="selectedMatch.logoB" class="w-10 h-10 rounded-full object-cover" />
            <span class="font-bold text-lg">{{ selectedMatch.equipeB }}</span>
          </div>
        </div>
        <p class="text-center mt-2 text-sm opacity-90" [ngClass]="{
          'text-green-300': selectedMatch.status === 'Terminer',
          'text-yellow-300': selectedMatch.status === 'En directe',
          'text-blue-200': selectedMatch.status === 'A venir'
        }">{{ selectedMatch.status | titlecase }}</p>
      </header>

      <section class="space-y-4">
        <div class="flex items-start gap-3">
          <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          <div>
            <p class="text-xs text-gray-500">Date</p>
            <p class="font-medium">{{ formatFullDate(selectedMatch.date) }}</p>
          </div>
        </div>

        <div class="flex items-start gap-3">
          <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <div>
            <p class="text-xs text-gray-500">Heure du Match</p>
            <p class="font-medium">{{ selectedMatch.date | date:'HH:mm' }}</p>
          </div>
        </div>

        <div class="flex items-start gap-3">
          <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
          </svg>
          <div>
            <p class="text-xs text-gray-500">Lieu</p>
            <p class="font-medium">{{ selectedMatch.lieu }}</p>
          </div>
        </div>

        <div class="flex items-start gap-3">
          <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
          </svg>
          <div>
            <p class="text-xs text-gray-500">Catégorie</p>
            <p class="font-medium">{{ selectedMatch.categorie }}</p>
          </div>
        </div>
      </section>
    </div>
  </div>

</div>